.. _3.0.7-1.0:

====================================
Percona Server for MongoDB 3.0.7-1.0
====================================

Percona is glad to announce the release of Percona Server for MongoDB 3.0.7 on December 14, 2015. Downloads are available `here <https://www.percona.com/downloads/percona-server-for-mongodb>`_ and from the :ref:`Percona Software Repositories <install>`.

Percona Server for MongoDB is a highly scalable, zero-maintenance downtime database supporting the MongoDB v3.0 protocol and drivers. The latest release is based on `MongoDB 3.0.7 <http://docs.mongodb.org/manual/release-notes/3.0/#oct-13-2015>`_, extending MongoDB with `MongoRocks <http://rocksdb.org>`_ and :ref:`PerconaFT <perconaft>` storage engines, as well as several enterprise features. Percona Server for MongoDB requires no changes to MongoDB applications or code.

.. note:: The MongoRocks engine included in this release is based on *RocksDB 4.0.0*. For more information, see the `RocksDB changelog <https://github.com/facebook/rocksdb/blob/master/HISTORY.md>`_.

New Features
============

* :ref:`toku-backup` is an integrated open-source hot backup system for |MongoDB| servers running the :ref:`PerconaFT <perconaft>` storage engine (including |Percona Server for MongoDB|).

* Concurrency optimization for lock-managed storage engines, such as PerconaFT. Pre-locking document ranges on index scans greatly improves performance of such engines.

Bug Fixes
=========

* PSMDB-18: Changed the default data directory (``dbpath``) to :file:`/var/lib/mongo` for RHEL/CentOS.

* PSMDB-28: Fixed an ``Invariant failure`` when creating a sparse index with the *WiredTiger* storage engine.

Build and Packaging Fixes
=========================

* BLD-331: Fixed the ``service mongod stop`` command for Debian.

* BLD-332: Fixed logic for :file:`percona-server-mongodb-helper.sh` script to correctly handle Transparent Huge Pages.

* BLD-343: Added the ``postrm`` script with appropriate logic to handle proper data files removal when running ``apt-get purge``.

* BLD-344: Switched to new YAML configuration format.

* BLD-369: Changed the ``mongod`` installation path to :file:`/usr/bin`.

* Fixed the ``mongod`` system group creation command.

PerconaFT Fixes
===============

* `FT-456 <https://tokutek.atlassian.net/browse/FT-456>`_: Serialized FT fanout to disk

* `FT-675 <https://tokutek.atlassian.net/browse/FT-675>`_: Removed unnecessary assertion on ``setlocale()`` success in ``ctest`` suite

* `FT-681 <https://tokutek.atlassian.net/browse/FT-681>`_: Fixed transactional inconsistency with rollback

* `FT-682 <https://tokutek.atlassian.net/browse/FT-682>`_: Reduced the amount of ``malloc_usable_size()`` calls

* `FT-684 <https://tokutek.atlassian.net/browse/FT-684>`_: Implemented a *logical row count* mechanism to make the estimated number of rows reflect the actual number of rows in heavily used tables

* `FT-685 <https://tokutek.atlassian.net/browse/FT-685>`_: Introduced branch prediction macros

* `FT-688 <https://tokutek.atlassian.net/browse/FT-688>`_: Changed licensing and naming from *Tokutek* to *Percona*

* `FT-690 <https://tokutek.atlassian.net/browse/FT-690>`_: Fixed ``reserved_filenum`` overflow

* `FT-692 <https://tokutek.atlassian.net/browse/FT-692>`_: Added a dummy field to make ``sizeof(DB_LSN)`` equal in C and C++

* `FT-699 <https://tokutek.atlassian.net/browse/FT-699>`_: Added and replaced field initializers that caused build fails

* `FT-702 <https://tokutek.atlassian.net/browse/FT-702>`_: Replaced the ``ZERO_COND_INITIALIZER`` definition with an empty brace pair intializer to stop build fails

* Fixed memory leak due to data race in context status initialization

* Fixed memory leak found with address sanitizer

* Fixed assert in circular buffer assert caused by race

* Improved database creation time

* Implemented grabbing of evictor mutex when signaling the evictor condition variable
